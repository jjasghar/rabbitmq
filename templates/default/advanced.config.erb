 %% ----------------------------------------------------------------------------
 %% Advanced Erlang Networking/Clustering Options.
 %%

[
  <% if node['rabbitmq']['kernel'] -%>
  {kernel, [
    <%= @kernel %>
  ]}
  <% end -%>
  <% if node['rabbitmq']['ldap']['enabled'] -%>
    ,
  {rabbitmq_auth_backend_ldap, [
    <% node['rabbitmq']['ldap']['conf'].each_with_index do |(key, value), index|  -%>
      <% if index == 0 %>
      {<%= key %>, <%= value %>}
      <% else %>
	    ,{<%= key %>, <%= value %>}
      <% end %>
    <% end %>
  ]}
  <% end -%>
].
